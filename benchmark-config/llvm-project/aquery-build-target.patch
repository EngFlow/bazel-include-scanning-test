From 11df48bdefc46fdf0121f1c7bd12045cf568f885 Mon Sep 17 00:00:00 2001
From: Phil Dawson <phil.dawson@codethink.co.uk>
Date: Mon, 18 Oct 2021 10:14:18 +0100
Subject: [PATCH] add target depending on external @llvm-project targets

---
 utils/bazel/BUILD.bazel | 124 +++++++++++++++++++++++++++++++++++++++-
 1 file changed, 123 insertions(+), 1 deletion(-)

diff --git a/utils/bazel/BUILD.bazel b/utils/bazel/BUILD.bazel
index dd837093c62a..5ef431efc7c4 100644
--- a/utils/bazel/BUILD.bazel
+++ b/utils/bazel/BUILD.bazel
@@ -2,4 +2,126 @@
 # See https://llvm.org/LICENSE.txt for license information.
 # SPDX-License-Identifier: Apache-2.0 WITH LLVM-exception
 
-# Required to reference .bzl files in this package
+filegroup(
+    name = "llvm",
+    # This list is all the targets from llvm-project-overlay/llvm/BUILD.bazel
+    # The testonly and windows specific targets have been stripped out
+    srcs = [
+        "@llvm-project//llvm:targets_def_gen",
+        "@llvm-project//llvm:asm_printers_def_gen",
+        "@llvm-project//llvm:asm_parsers_def_gen",
+        "@llvm-project//llvm:disassemblers_def_gen",
+        "@llvm-project//llvm:target_mca_def_gen",
+        "@llvm-project//llvm:version_info_gen",
+        "@llvm-project//llvm:abi_breaking_h_gen",
+        "@llvm-project//llvm:config",
+        "@llvm-project//llvm:Demangle",
+        "@llvm-project//llvm:generate_vcs_revision",
+        "@llvm-project//llvm:generate_static_extension_registry",
+        "@llvm-project//llvm:Support",
+        "@llvm-project//llvm:FileCheckLib",
+        "@llvm-project//llvm:LineEditor",
+        "@llvm-project//llvm:Option",
+        "@llvm-project//llvm:TableGen",
+        "@llvm-project//llvm:ir_headers",
+        "@llvm-project//llvm:BinaryFormat",
+        "@llvm-project//llvm:DebugInfo",
+        "@llvm-project//llvm:DebugInfoMSF",
+        "@llvm-project//llvm:DebugInfoCodeView",
+        "@llvm-project//llvm:DebugInfoPDB",
+        "@llvm-project//llvm:MC",
+        "@llvm-project//llvm:DebugInfoDWARF",
+        "@llvm-project//llvm:Symbolize",
+        "@llvm-project//llvm:tblgen",
+        "@llvm-project//llvm:intrinsic_enums_gen",
+        "@llvm-project//llvm:intrinsics_impl_gen",
+        "@llvm-project//llvm:attributes_gen",
+        "@llvm-project//llvm:BitstreamReader",
+        "@llvm-project//llvm:BitstreamWriter",
+        "@llvm-project//llvm:Remarks",
+        "@llvm-project//llvm:remark_linker",
+        "@llvm-project//llvm:llvm_intrinsics_headers",
+        "@llvm-project//llvm:Core",
+        "@llvm-project//llvm:BitReader",
+        "@llvm-project//llvm:MCParser",
+        "@llvm-project//llvm:TextAPI",
+        "@llvm-project//llvm:Object",
+        "@llvm-project//llvm:ObjectYAML",
+        "@llvm-project//llvm:ProfileData",
+        "@llvm-project//llvm:Coverage",
+        "@llvm-project//llvm:Analysis",
+        "@llvm-project//llvm:BitWriter",
+        "@llvm-project//llvm:Target",
+        "@llvm-project//llvm:DWP",
+        "@llvm-project//llvm:TransformUtils",
+        "@llvm-project//llvm:InstCombineTableGen",
+        "@llvm-project//llvm:InstCombine",
+        "@llvm-project//llvm:AggressiveInstCombine",
+        "@llvm-project//llvm:Instrumentation",
+        "@llvm-project//llvm:ObjCARC",
+        "@llvm-project//llvm:Scalar",
+        "@llvm-project//llvm:Vectorize",
+        "@llvm-project//llvm:omp_td_files",
+        "@llvm-project//llvm:FrontendOpenMP",
+        "@llvm-project//llvm:acc_td_files",
+        "@llvm-project//llvm:FrontendOpenACC",
+        "@llvm-project//llvm:AsmParser",
+        "@llvm-project//llvm:IRReader",
+        "@llvm-project//llvm:Linker",
+        "@llvm-project//llvm:IPO",
+        "@llvm-project//llvm:CFGuard",
+        "@llvm-project//llvm:Coroutines",
+        "@llvm-project//llvm:common_transforms",
+        "@llvm-project//llvm:asm_printer_defs",
+        "@llvm-project//llvm:CodeGen",
+        "@llvm-project//llvm:MCDisassembler",
+        "@llvm-project//llvm:x86_target_layering_problem_hdrs",
+        "@llvm-project//llvm:common_target_td_sources",
+        "@llvm-project//llvm:amdgpu_isel_target_gen",
+        "@llvm-project//llvm:r600_target_gen",
+        "@llvm-project//llvm:AllTargetsCodeGens",
+        "@llvm-project//llvm:AllTargetsAsmParsers",
+        "@llvm-project//llvm:AllTargetsDisassemblers",
+        "@llvm-project//llvm:AllTargetsMCAs",
+        "@llvm-project//llvm:pass_registry_def",
+        "@llvm-project//llvm:MLPolicies",
+        "@llvm-project//llvm:Passes",
+        "@llvm-project//llvm:LTO",
+        "@llvm-project//llvm:ExecutionEngine",
+        "@llvm-project//llvm:Interpreter",
+        "@llvm-project//llvm:JITLink",
+        "@llvm-project//llvm:MCJIT",
+        "@llvm-project//llvm:OrcJIT",
+        "@llvm-project//llvm:OrcShared",
+        "@llvm-project//llvm:OrcTargetProcess",
+        "@llvm-project//llvm:DWARFLinker",
+        "@llvm-project//llvm:DllOptionsTableGen",
+        "@llvm-project//llvm:DlltoolDriver",
+        "@llvm-project//llvm:LibOptionsTableGen",
+        "@llvm-project//llvm:LibDriver",
+        "@llvm-project//llvm:InterfaceStub",
+        "@llvm-project//llvm:MCA",
+        "@llvm-project//llvm:XRay",
+        "@llvm-project//llvm:DsymutilTableGen",
+        "@llvm-project//llvm:dsymutil",
+        "@llvm-project//llvm:llc",
+        "@llvm-project//llvm:lli",
+        "@llvm-project//llvm:CvtResTableGen",
+        "@llvm-project//llvm:CxxfiltOptsTableGen",
+        "@llvm-project//llvm:LipoOptsTableGen",
+        "@llvm-project//llvm:MlTableGen",
+        "@llvm-project//llvm:MtTableGen",
+        "@llvm-project//llvm:NmOptsTableGen",
+        "@llvm-project//llvm:ObjdumpOptsTableGen",
+        "@llvm-project//llvm:OtoolOptsTableGen",
+        "@llvm-project//llvm:RcTableGen",
+        "@llvm-project//llvm:WindresTableGen",
+        "@llvm-project//llvm:ReadobjOptsTableGen",
+        "@llvm-project//llvm:SizeOptsTableGen",
+        "@llvm-project//llvm:StringsOptsTableGen",
+        "@llvm-project//llvm:SymbolizerOptsTableGen",
+        "@llvm-project//llvm:opt",
+        "@llvm-project//llvm:sancov",
+        "@llvm-project//llvm:sanstats",
+    ],
+)
\ No newline at end of file
-- 
2.20.1

